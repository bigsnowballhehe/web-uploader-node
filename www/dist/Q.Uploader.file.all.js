//devin87@qq.com
//build:2020/07/22 20:02:59
!function(n,a){"use strict";var e,s,o,t=Object.prototype.toString,i=Object.prototype.hasOwnProperty,r=Array.prototype.slice;function l(e,t){return e!==a?e:t}function u(e){return"[object Function]"===t.call(e)}function c(e){return"number"==typeof e&&0<e&&e===Math.floor(e)}function d(e,t,n){if(!e||!t)return e;for(var r in t)r!=a&&i.call(t,r)&&(n||e[r]===a)&&(e[r]=t[r]);return e}function f(e,t,n,r){for(var i=e[n||t],a=[];i;){if(1==i.nodeType){if(!r)return i;a.push(i)}i=i[t]}return r?a:null}function p(e){return e.firstElementChild||f(e,"nextSibling","firstChild",!1)}function h(e,t,n){var r=document.createElement(e);return t&&(r.className=t),n&&(r.innerHTML=n),r}function v(e){var t=e||n.event;return t.target||(t.target=t.srcElement),t}d(Object,{forEach:function(e,t,n){for(var r in e)i.call(e,r)&&t.call(n,r,e[r],e)}}),d(Array.prototype,{forEach:function(e,t){for(var n=this,r=0,i=n.length;r<i;r++)r in n&&e.call(t,n[r],r,n)}}),d(Date,{now:function(){return+new Date}}),(n.ActiveXObject||n.msIndexedDB)&&(e=document.documentMode||(n.XMLHttpRequest?7:6)),n.JSON||(n.JSON={}),JSON.parse||(JSON.parse=function(e,t){if(!1!==t&&!/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))throw new Error("JSON SyntaxError");try{return new Function("return "+e)()}catch(e){}}),document.addEventListener?(s=function(e,t,n){e.addEventListener(t,n,!1)},o=function(e,t,n){e.removeEventListener(t,n,!1)}):document.attachEvent&&(s=function(e,t,n){e.attachEvent("on"+t,n)},o=function(e,t,n){e.detachEvent("on"+t,n)});var m=/^https?:\/\//i;function g(e){return m.test(e)}function y(e,t,n){e=+e;for(var r=0,i="number"==typeof(t=t||1024),a=1,s=c(n)?n:i?100:t.length;a<=e&&r<s;)a*=i?t:t[r],r++;return r&&e<a&&(a/=i?t:t.last(),r--),{value:r?e/a:e,level:r}}var _=["B","KB","MB","GB","TB","PB","EB"];var w={def:l,isFunc:u,isUInt:c,fire:function(e,t){if(u(e))return e.apply(t,r.call(arguments,2))},extend:d,ie:e,setOpacity:function(e,t){t<=1&&(t*=100),e.style.opacity!=a?e.style.opacity=t/100:e.style.filter!=a&&(e.style.filter="alpha(opacity="+parseInt(t)+")")},getOffset:function(e,t){for(var n=0,r=0,i=e.offsetWidth,a=e.offsetHeight;n+=e.offsetLeft,r+=e.offsetTop,(e=e.offsetParent)&&e!=t;);return{left:n,top:r,width:i,height:a}},walk:f,getPrev:function(e){return e.previousElementSibling||f(e,"previousSibling",null,!1)},getNext:function(e){return e.nextElementSibling||f(e,"nextSibling",null,!1)},getFirst:p,getLast:function(e){return e.lastElementChild||f(e,"previousSibling","lastChild",!1)},getChilds:function(e){return e.children||f(e,"nextSibling","firstChild",!0)},createEle:h,parseHTML:function(e,t){var n=h("div","",e);return t?n.childNodes:p(n)},isHttpURL:g,isSameHost:function(e){if(!g(e))return!0;var t=RegExp.lastMatch.length,n=e.indexOf("/",t);return e.slice(0,-1!=n?n:a).toLowerCase()==(location.protocol+"//"+location.host).toLowerCase()},parseLevel:y,formatSize:function(e,t){if(t=!0===t?{all:!0}:t||{},isNaN(e)||e==a||e<0){var n=t.error||"--";return t.all?{text:n}:n}var r=y(e,t.steps,t.limit),i=r.value.toFixed(l(t.digit,2));return!1!==t.trim&&-1!=i.lastIndexOf(".")&&(i=i.replace(/\.?0+$/,"")),r.text=i+(t.join||"")+(t.units||_)[r.level+(t.start||0)],t.all?r:r.text}};e&&(w["ie"+(e<6?6:e)]=!0),w.event={fix:v,stop:function(e,t,n){var r=v(e);!1!==t&&(r.preventDefault?r.preventDefault():r.returnValue=!1),!1!==n&&(r.stopPropagation?r.stopPropagation():r.cancelBubble=!0)},trigger:function(e,t){if(u(e[t]))e[t]();else if(e.fireEvent)e.fireEvent("on"+t);else if(e.dispatchEvent){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}},add:function(t,n,r,i){var a=function(e){r.call(t,v(e)),i&&o(t,n,a)};if(s(t,n,a),!i)return{stop:function(){o(t,n,a)}}}},n.Q=w}(window),function(n,c){"use strict";var i=Q.def,o=Q.fire,a=Q.extend,d=Q.getFirst,f=Q.getLast,l=JSON.parse,p=Q.createEle,s=Q.parseHTML,h=Q.setOpacity,u=Q.getOffset||Q.offset,v=Q.md5File,e=Q.event,m=e.add,g=e.trigger,y=e.stop,_=!1,w=!1,x=!1,r=0,E=0,S=0,b={};function T(e,t){var n=e.lastIndexOf(t);return-1!=n?e.slice(n):""}function k(e){if(e){for(var t=e.split(","),n={},r=0,i=t.length;r<i;r++)n[t[r]]=!0;return n}}function L(e){var t=this,n=e||{};t.guid=n.guid||"uploader"+ ++r,t.list=[],t.map={},t.index=0,t.started=!1,t.set(n)._init()}L.prototype={constructor:L,set:function(e){var t=this,n=a(e,t.ops);t.url=n.url,t.dataType=n.dataType||"json",t.data=n.data,t.targets=n.target||[],t.targets.forEach||(t.targets=[t.targets]),t.target=t.targets[0],t.html5=_&&!!i(n.html5,!0),t.multiple=w&&t.html5&&!!i(n.multiple,!0),t.clickTrigger=x&&!!i(n.clickTrigger,!0),t.workerThread=t.html5&&n.workerThread||1,t.workerIdle=t.workerThread,t.auto=!1!==n.auto,t.upName=n.upName||"upfile",t.accept=n.accept||(0==(navigator.platform||"").indexOf("Win")?n.allows:"*/*"),t.isDir=n.isDir,t.allows=k(n.allows),t.disallows=k(n.disallows),t.maxSize=+n.maxSize||0,t.isSlice=!!n.isSlice,t.chunkSize=+n.chunkSize||2097152,t.isQueryState=!!i(n.isQueryState,t.isSlice),t.isMd5=!!i(n.isMd5,t.isSlice),t.isUploadAfterHash=!1!==n.isUploadAfterHash,t.sliceRetryCount=n.sliceRetryCount==c?2:+n.sliceRetryCount||0,t.container=n.container||document.body,n.getPos&&(t.getPos=n.getPos);var r=n.UI||{};return r.init&&(t.init=r.init),r.draw&&(t.draw=r.draw),r.update&&(t.update=r.update),r.over&&(t.over=r.over),t.fns=n.on||{},t.ops=n,t.accept&&!t.clickTrigger&&t.resetInput(),t},_init:function(){var t=this;if(!t._inited){t._inited=!0;var e,n,r=t.guid,i=t.container,a=p("div","upload-input "+r);if(i.appendChild(a),t.boxInput=a,!t.html5){var s="upload_iframe_"+r,o=p("div","upload-html4 "+r,'<iframe class="u-iframe" name="'+s+'"></iframe><form class="u-form" action="" method="post" enctype="multipart/form-data" target="'+s+'"></form>');i.appendChild(o);var l=d(o),u=f(o);t.iframe=l,t.form=u,n=function(){if(0==t.workerIdle){var e;try{e=l.contentWindow.document.body.innerHTML}catch(e){}t.complete(c,2,e)}},(e=l).attachEvent?e.attachEvent("onload",n):e.addEventListener("load",n,!1)}return t.targets.forEach(function(e){t.clickTrigger?m(e,"click",function(e){!1!==t.fire("select",e)&&(t.resetInput(),g(t.inputFile,"click"))}):m(e,"mouseover",function(e){t.target=this,t.updatePos()})}),t.clickTrigger||(m(a,"click",function(e){!1===t.fire("select",e)&&y(e)}),h(a,0),t.resetInput()),t.run("init",c,"init")}},resetInput:function(){var t=this,e=t.boxInput;if(!e)return t;e.innerHTML='<input type="file" name="'+t.upName+'"'+(t.accept?'accept="'+t.accept+'"':"")+(t.isDir?'webkitdirectory=""':"")+' style="'+(t.clickTrigger?"visibility: hidden;":"font-size:100px;")+'"'+(t.multiple?' multiple="multiple"':"")+">";var n=d(e);return m(n,"change",function(e){t.add(this),t.html5||t.resetInput()}),t.inputFile=n,t.updatePos()},updatePos:function(e){var t=this;if(t.clickTrigger)return t;var n=t.getPos||u,r=t.boxInput,i=d(r),a=t.target,s=a.offsetWidth,o=a.offsetHeight,l=0==s?{left:-1e4,top:-1e4}:n(a);return r.style.width=i.style.width=s+"px",r.style.height=i.style.height=o+"px",r.style.left=l.left+"px",r.style.top=l.top+"px",e&&(r.style.zIndex=++S),t},fire:function(e,t,n){if(!n)return o(this.fns[e],this,t);var r=this.fns[e+"Async"];if(r)return o(r,this,t,n);n(o(this.fns[e],this,t))},run:function(e,t,n){var r=this[e];return r&&o(r,this,t),n&&o(this.fns[n],this,t),this},addTask:function(e,t){if(e||t){var n,r;r=t?(n=t.webkitRelativePath||t.name||t.fileName,0===t.size?0:t.size||t.fileSize):(n=T(e.value,"\\").slice(1)||e.value,-1);var i,a=this,s=T(n,".").toLowerCase();a.disallows&&a.disallows[s]||a.allows&&!a.allows[s]?i="ext":-1!=r&&a.maxSize&&r>a.maxSize&&(i="size");var o={id:++E,name:n,ext:s,size:r,input:e,file:t,state:i?-1:0};return i&&(o.limited=i,o.disabled=!0),a.fire("add",o,function(e){!1===e||o.disabled||o.limited||(o.index=a.list.length,a.list.push(o),a.map[o.id]=o,a.run("draw",o,"draw"),a.auto&&a.start())}),o}},add:function(e){if("INPUT"==e.tagName){var t=e.files;if(t)for(var n=0,r=t.length;n<r;n++)this.addTask(e,t[n]);else this.addTask(e)}else this.addTask(c,e)},addList:function(e){for(var t=0,n=e.length;t<n;t++)this.add(e[t])},get:function(e){if(e!=c)return this.map[e]},cancel:function(e,t){var n=this,r=n.get(e);if(r){var i=r.state;if(0!=i&&1!=i)return n;if(1==i){var a=r.xhr;if(a)return a.abort(),n;n.iframe.contentWindow.location="about:blank"}return t?n:n.complete(r,-2)}},remove:function(e){var t=this.get(e);t&&(1==t.state&&this.cancel(e),t.deleted=!0,this.fire("remove",t))},start:function(){var e=this,t=e.workerIdle,n=e.list,r=e.index,i=n.length;if(e.started||(e.started=!0),i<=0||i<=r||t<=0)return e;var a=n[r];return e.index++,e.upload(a)},upload:function(t){var n=this;return!t||0!=t.state||t.skip||t.deleted?n.start():(t.url=n.url,n.workerIdle--,n.fire("upload",t,function(e){if(!1===e)return n.complete(t,-1);n.html5&&t.file?n._upload_html5_ready(t):t.input?n._upload_html4(t):n.complete(t,-1)}),n)},_process_xhr_headers:function(n){var e=this.ops,t=function(e,t){n.setRequestHeader(e,t)};b.headers&&Object.forEach(b.headers,t),e.headers&&Object.forEach(e.headers,t)},queryState:function(r,i){var a=this,e=a.url,s=new XMLHttpRequest,n=["action=query","hash="+(r.hash||encodeURIComponent(r.name)),"fileName="+encodeURIComponent(r.name)];return-1!=r.size&&n.push("fileSize="+r.size),a._process_params(r,function(e,t){n.push(encodeURIComponent(e)+"="+(t!=c?encodeURIComponent(t):""))},"dataQuery"),r.queryUrl=e+(-1==e.indexOf("?")?"?":"&")+n.join("&"),a.fire("sliceQuery",r),s.open("GET",r.queryUrl),a._process_xhr_headers(s),s.onreadystatechange=function(){if(4==s.readyState){var e,t;if(200<=s.status&&s.status<400)if("ok"===(e=s.responseText)?t={ret:1}:e&&(t=l(e)),t&&"number"!=typeof t||(t={ret:0,start:t}),r.response=e,1==(r.json=t).ret)r.queryOK=!0,a.cancel(r.id,!0).complete(r,2);else{var n=+t.start||0;n!=Math.floor(n)&&(n=0),r.sliceStart=n}o(i,a,s)}},s.onerror=function(){o(i,a,s)},s.send(null),a},_upload_html5_ready:function(r){var i=this,e=function(){2!=r.state&&(i.isSlice?i._upload_slice(r):i._upload_html5(r))},a=function(e){i.fire("hash",r,function(){r.hash&&i.isQueryState&&2!=r.state?i.queryState(r,e):e()})},t=function(n){if(i.isMd5&&v){var t=i.fns.hashProgress;v(r.file,function(e,t){r.hash=e,r.timeHash=t,a(n)},function(e){o(t,i,r,e)})}else a(n)};return i.isUploadAfterHash?t(e):(e(),t()),i},_process_params:function(e,t,n){n=n||"data",b.data&&Object.forEach(b.data,t),this.data&&Object.forEach(this.data,t),e&&e[n]&&Object.forEach(e[n],t)},_upload_html5:function(t){var n=this,r=new XMLHttpRequest;(t.xhr=r).upload.addEventListener("progress",function(e){n.progress(t,e.total,e.loaded)},!1),r.addEventListener("load",function(e){n.complete(t,2,e.target.responseText)},!1),r.addEventListener("error",function(){n.complete(t,-3)},!1),r.addEventListener("abort",function(){n.complete(t,-2)},!1);var i=new FormData;n._process_params(t,function(e,t){i.append(e,t)}),i.append("fileName",t.name),i.append(n.upName,t.blob||t.file,t.name),r.open("POST",t.url),n._process_xhr_headers(r),n.fire("send",t,function(e){if(!1===e)return n.complete(t,-1);r.send(i),n._afterSend(t)})},_upload_html4:function(t){var n=this,r=n.form,e=t.input;if(e._uploaded)return n.complete(t,2);e._uploaded=!0,e.name=n.upName,r.innerHTML="",r.appendChild(e),r.action=t.url,n._process_params(t,function(e,t){r.appendChild(s('<input type="hidden" name="'+e+'" value="'+t+'">'))}),n.fire("send",t,function(e){if(!1===e)return n.complete(t,-1);r.submit(),n._afterSend(t)})},_afterSend:function(e){e.lastTime=e.startTime=Date.now(),e.state=1,this._lastTask=e,this.progress(e)},progress:function(e,t,n){t||(t=e.size),(!n||n<0)&&(n=0);var r=e.state||0;t<n&&(n=t),0<n&&0==r&&(e.state=r=1),2==r&&(t=n=e.size),function(e,t,n){if(t&&!(t<=0)){var r,i=Date.now();if(t<=n)return(r=i-e.startTime)?e.avgSpeed=Math.min(Math.round(1e3*t/r),t):e.speed||(e.avgSpeed=e.speed=t),e.time=r||0,e.endTime=i;(r=i-e.lastTime)<200||(e.speed=Math.min(Math.round(1e3*(n-e.loaded)/r),e.total),e.lastTime=i)}}(e,t,n),e.total=t,e.loaded=n,this.run("update",e,"progress")},_process_response:function(e,t){(e.response=t)&&"json"==this.dataType&&(e.json=l(t))},complete:function(e,t,n){var r=this;return e||1!=r.workerThread||(e=r._lastTask),e&&(t!=c&&(e.state=t),1!=e.state&&2!=t||(e.state=2,r.progress(e,e.size,e.size)),n!==c&&r._process_response(e,n)),r.run("update",e,"update").run("over",e,"over"),-2==t&&r.fire("cancel",e),r.fire("complete",e),r.workerIdle++,r.started&&r.start(),r}},L.extend=function(e,t){a(L.prototype,e,t)},function(){var e=n.XMLHttpRequest;e&&(new e).upload&&n.FormData&&(_=!0);var t=document.createElement("input");t.type="file",w=!!t.files,x=_}(),a(L,{support:{html5:_,multiple:w},READY:0,PROCESSING:1,COMPLETE:2,SKIP:-1,CANCEL:-2,ERROR:-3,UI:{},Lang:{status_ready:"准备中",status_processing:"上传中",status_complete:"已完成",status_skip:"已跳过",status_cancel:"已取消",status_error:"已失败"},setup:function(e){a(b,e,!0)},getStatusText:function(e){var t=L.Lang;switch(e){case 0:return t.status_ready;case 1:return t.status_processing;case 2:return t.status_complete;case-1:return t.status_skip;case-2:return t.status_cancel;case-3:return t.status_error}return e}}),Q.Uploader=L}(window),function(e,t){"use strict";var h=Q.def,v=Q.getFirst,m=Q.getLast,p=Q.getNext,g=Q.createEle,y=Q.formatSize,_=Q.event.add,w=Q.Uploader,x=w.Lang;function n(e,t){e.className+=" "+t}function E(e,t){e&&(e.innerHTML=t||"")}w.UI.File={init:function(){var e=this.ops.view;e&&n(e,"ui-file "+(this.html5?"html5":"html4"))},draw:function(e){var t=this,n=t.ops,r=n.view;if(r){var i=n.button||{},a=h(x.cancel||i.cancel,"取消"),s=h(x.remove||i.remove,"删除"),o=e.name,l='<div class="fl"><div class="u-name" title="'+o+'">'+o+'</div></div><div class="fr"><div class="u-size"></div><div class="u-speed">--/s</div><div class="u-progress-bar"><div class="u-progress" style="width:1%;"></div></div><div class="u-detail">0%</div><div class="u-state"></div><div class="u-op"><a class="u-op-cancel">'+a+'</a><a class="u-op-remove">'+s+'</a></div></div><div class="clear"></div>',u=e.id,c=g("div","u-item",l);c.taskId=u,e.box=c,r.appendChild(c);var d=m(c.childNodes[1]),f=v(d),p=m(d);_(f,"click",function(){t.cancel(u)}),_(p,"click",function(){t.remove(u),r.removeChild(c)}),t.update(e)}},update:function(e){if(e&&e.box){var t=e.total||e.size,n=e.loaded,r=e.state,i=e.box.childNodes[1],a=v(i),s=p(a),o=p(s),l=v(o),u=p(o);if(E(p(u),w.getStatusText(r)),!(t<0)){var c="";if(this.html5&&null!=n&&0<=n){var d;if(r==w.PROCESSING)"100.0"==(d=Math.min(100*n/t,100).toFixed(1))&&(d="99.9");else r==w.COMPLETE&&(d="100");d&&(d+="%",E(u,l.style.width=d)),c='<span class="u-loaded">'+y(n)+"</span> / ";var f=e.avgSpeed||e.speed;E(s,y(f)+"/s")}E(a,c+='<span class="u-total">'+y(t)+"</span>")}}},over:function(e){e&&e.box&&n(e.box,"u-over")}},w.extend(w.UI.File)}(window);